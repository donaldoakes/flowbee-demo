attributes:
  ArrowStyle: ArrowEnd
  NodeStyle: BoxIcon
  PROCESS_VISIBILITY: PUBLIC
  PerformanceLevel: '0'
  display: x=48,y=41,w=188,h=26
steps:
- id: s1
  name: Start
  path: flowbee-demo.start
  attributes:
    display: x=90,y=160,w=60,h=40
  links:
  - id: l1
    attributes:
      display: type=Elbow,x=190,y=180,xs=154&226,ys=180&180
    to: s4
- id: s2
  name: Stop
  path: flowbee-demo.stop
  attributes:
    display: x=610,y=160,w=60,h=40
- id: s3
  name: |-
    Create
    Incident
  path: flowbee-demo.servicenow.ServiceNowAdapter
  attributes:
    AuthPassword: ${env['SERVICENOW_PASSWORD']}
    AuthUser: ${env['SERVICENOW_USER']}
    EndpointUri: ${props['servicenow.url']}/table/incident
    REQUEST_VARIABLE: incident
    RESPONSE_VARIABLE: incidentResponse
    display: x=420,y=140,w=120,h=80
  links:
  - id: l2
    attributes:
      display: type=Elbow,x=575,y=180,xs=544&606,ys=180&180
    to: s2
- id: s4
  name: |-
    Build
    Request
  path: flowbee-demo.script.ScriptExecutorActivity
  attributes:
    Output Documents: '["incident"]'
    Rule: |
      import servicenow.Incident

      import servicenow.GlideDateTime

      incident = new Incident()
      incident.shortDescription = 'Houston we have a problem'
      incident.urgency = Incident.Level.High
      incident.impact = Incident.Level.Medium
      incident.correlationId = runtimeContext.processInstanceId.toString()
      incident.correlationDisplay = 'Process Instance'
      incident.caller = 'Flowbee Demo Application'
      incident.assignmentGroup = 'Flowbee Support'
      incident.category = 'General Inquiry'
      incident.dueDate = new GlideDateTime(System.currentTimeMillis() + 24 * 60 * 60 * 1000).localDateTime
    SCRIPT: Groovy
    display: x=230,y=140,w=120,h=80
  links:
  - id: l3
    attributes:
      display: type=Elbow,x=385,y=180,xs=354&416,ys=180&180
    to: s3
variables:
  incident:
    type: io.limberest.json.Jsonable
  incidentResponse:
    type: org.json.JSONObject
