attributes:
  ArrowStyle: ArrowEnd
  NodeStyle: BoxIcon
  PROCESS_VISIBILITY: PUBLIC
  display: x=41,y=46,w=93,h=27
steps:
- id: S1
  name: Start
  specifier: com.centurylink.mdw.workflow.activity.process.ProcessStartActivity
  attributes:
    display: x=33,y=108,w=60,h=40
  links:
  - id: L7
    attributes:
      display: type=Elbow,x=111,y=150,xs=97&134,ys=128&187
    event: FINISH
    to: S10
- id: S2
  name: Right
  specifier: com.centurylink.mdw.workflow.activity.process.ProcessFinishActivity
  attributes:
    display: x=387,y=404,w=60,h=40
- id: S3
  name: Decide
  specifier: com.centurylink.mdw.kotlin.ScriptActivity
  attributes:
    Rule: "println(\"kotlin eval testing...\")\r\n\r\ncheck(variables[\"numFlavs\"] == 31) { \"Invalid value for variable numFlavs\" }\r\n\r\nvariables[\"flavor\"]"
    SCRIPT: Kotlin Script
    display: x=126,y=391,w=100,h=60
  links:
  - id: L2
    attributes:
      display: type=Elbow,x=281,y=406,xs=230&383,ys=424&424
    event: FINISH
    to: S2
    result: Chocolate
  - id: L3
    attributes:
      display: type=Elbow,x=183,y=480,xs=176&176,ys=455&515
    event: FINISH
    to: S4
    result: Vanilla
- id: S4
  name: Wrong
  specifier: com.centurylink.mdw.workflow.activity.process.ProcessFinishActivity
  attributes:
    display: x=146,y=519,w=60,h=40
- id: S5
  name: Exec
  specifier: com.centurylink.mdw.kotlin.ScriptActivity
  attributes:
    Output Documents: '["jsonablePerson"]'
    Rule: "import com.centurylink.mdw.tests.script.Person\r\n\r\nvar person: Person = variables[\"jsonablePerson\"] as Person\r\n\r\n// simple set variable\r\nvariables[\"jsonablePersonName\"] = person.getName()\r\nvariables[\"mrid\"] = runtimeContext.masterRequestId\r\n\r\n// update json content\r\nperson.firstName = \"Linus\"\r\nperson.lastName = \"Torvalds\"\r\n\r\n"
    SCRIPT: Kotlin Script
    display: x=289,y=160,w=100,h=65
  links:
  - id: L10
    attributes:
      display: type=Elbow,x=425,y=193,xs=393&448,ys=193&193
    event: FINISH
    to: S13
- id: S9
  name: Finish
  specifier: com.centurylink.mdw.workflow.activity.process.ProcessFinishActivity
  attributes:
    display: x=620,y=286,w=60,h=40
- id: S10
  name: Which
  specifier: com.centurylink.mdw.workflow.activity.script.ScriptEvaluator
  attributes:
    Expression: variables["testCase"]
    SCRIPT: Kotlin Script
    display: x=138,y=156,w=79,h=63
  links:
  - id: L1
    attributes:
      display: type=Elbow,x=188,y=242,xs=177&177,ys=223&279
    event: FINISH
    to: S11
    result: decide
  - id: L4
    attributes:
      display: type=Elbow,x=249,y=173,xs=221&285,ys=189&189
    event: FINISH
    to: S5
    result: exec
- id: S11
  name: Boolean
  specifier: com.centurylink.mdw.workflow.activity.script.ScriptEvaluator
  attributes:
    Expression: '"decide".equals(variables["testCase"])'
    SCRIPT: Kotlin Script
    display: x=135,y=283,w=83,h=60
  links:
  - id: L8
    attributes:
      display: type=Elbow,x=182,y=351,xs=176&176,ys=347&387
    event: FINISH
    to: S3
    result: 'true'
  - id: L9
    attributes:
      display: type=Elbow,x=234,y=298,xs=222&281,ys=316&316
    event: FINISH
    to: S12
    result: 'false'
- id: S12
  name: No Way
  specifier: com.centurylink.mdw.workflow.activity.process.ProcessFinishActivity
  attributes:
    display: x=285,y=296,w=60,h=40
- id: S13
  name: Use Class
  specifier: com.centurylink.mdw.kotlin.ScriptActivity
  attributes:
    Output Documents: '["jsonObject"]'
    Rule: "import com.centurylink.mdw.tests.script.Person\r\nimport com.centurylink.mdw.tests.script.PersonLookup\r\n\r\n// update document value, and reflect changes made previously\r\nval person = variables[\"jsonablePerson\"] as Person\r\nvariables[\"jsonObject\"] = PersonLookup.find(person.lastName!!).getJson()"
    SCRIPT: Kotlin Script
    display: x=452,y=162,w=100,h=62
  links:
  - id: L11
    attributes:
      display: type=Elbow,x=552,y=253,xs=504&504,ys=228&273
    event: FINISH
    to: S14
- id: S14
  name: "Access\r\nfrom Java"
  specifier: com.centurylink.mdw.workflow.activity.java.DynamicJavaActivity
  attributes:
    Java: |
      package com.centurylink.mdw.tests.script;

      import java.util.Map;

      import com.centurylink.mdw.java.JavaExecutionException;
      import com.centurylink.mdw.java.JavaExecutor;
      import com.centurylink.mdw.java.MdwJavaException;
      import com.centurylink.mdw.model.workflow.ActivityRuntimeContext;

      /**
       * Access kotlin from java.
       */
      public class AccessfromJava_A14 implements JavaExecutor {

          public void initialize(ActivityRuntimeContext context) throws MdwJavaException {
          }

          public Object execute(Map<String,Object> variables) throws JavaExecutionException {
              variables.put("unfound", PersonLookup.find("Brin").getJson());
              return null;
          }
      }
    Output Documents: '["unfound"]'
    display: x=457,y=277,w=99,h=66
  links:
  - id: L12
    attributes:
      display: type=Elbow,x=589,y=306,xs=560&616,ys=306&306
    event: FINISH
    to: S9
variables:
  flavor:
    type: java.lang.String
  jsonObject:
    type: org.json.JSONObject
  jsonablePerson:
    type: com.centurylink.mdw.model.Jsonable
  jsonablePersonName:
    type: java.lang.String
  mrid:
    type: java.lang.String
  numFlavs:
    type: java.lang.Integer
  testCase:
    type: java.lang.String
  unfound:
    type: org.json.JSONObject
  yamlPerson:
    type: org.yaml.snakeyaml.Yaml
