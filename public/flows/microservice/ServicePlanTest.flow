attributes:
  ArrowStyle: ArrowEnd
  NodeStyle: BoxIcon
  PROCESS_VISIBILITY: PUBLIC
  display: x=40,y=39,w=151,h=26
steps:
- id: S1
  name: Start
  specifier: com.centurylink.mdw.workflow.activity.process.ProcessStartActivity
  attributes:
    display: x=32,y=129,w=60,h=40
  links:
  - id: L1
    attributes:
      display: type=Elbow,x=123,y=149,xs=95&152,ys=149&149
    event: FINISH
    to: S5
- id: S2
  name: Stop
  specifier: com.centurylink.mdw.workflow.activity.process.ProcessFinishActivity
  attributes:
    display: x=494,y=299,w=60,h=40
- id: S4
  name: "Create\r\nServicePlan"
  specifier: com.centurylink.mdw.kotlin.ScriptActivity
  attributes:
    Output Documents: '["servicePlan"]'
    Rule: "import com.centurylink.mdw.tests.microservice.ServicePlanTest\r\n\r\nval servicePlanTest = ServicePlanTest()\r\n\r\nwhen (variables[\"testCase\"]) {\r\n  \"defaultBindings\" -> {\r\n    variables[\"servicePlan\"] = servicePlanTest.defaultBindings()\r\n  }\r\n  \"customBindings\" -> {\r\n    variables[\"servicePlan\"] = servicePlanTest.customBindings()\r\n  }\r\n}"
    SCRIPT: Kotlin Script
    display: x=322,y=118,w=105,h=71
  links:
  - id: L2
    attributes:
      display: type=Elbow,x=478,y=224,xs=431&525,ys=153&295
    event: FINISH
    to: S2
- id: S5
  name: Which?
  specifier: com.centurylink.mdw.workflow.activity.script.ScriptEvaluator
  attributes:
    Expression: variables["language"]
    SCRIPT: Kotlin Script
    display: x=156,y=122,w=85,h=55
  links:
  - id: L3
    attributes:
      display: type=Elbow,x=264,y=156,xs=245&318,ys=148&148
    event: FINISH
    to: S4
    result: Kotlin
  - id: L4
    attributes:
      display: type=Elbow,x=207,y=230,xs=198&198,ys=181&273
    event: FINISH
    to: S6
    result: Java
- id: S6
  name: |-
    Java
    ServicePlan
  specifier: com.centurylink.mdw.workflow.activity.java.DynamicJavaActivity
  attributes:
    ClassName: ServicePlanTest_A6
    Java: "package com.centurylink.mdw.tests.microservice;\n\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\nimport com.centurylink.mdw.java.JavaExecutionException;\nimport com.centurylink.mdw.java.JavaExecutor;\nimport com.centurylink.mdw.java.MdwJavaException;\nimport com.centurylink.mdw.microservice.ServicePlan;\nimport com.centurylink.mdw.model.workflow.ActivityRuntimeContext;\nimport com.centurylink.mdw.microservice.Microservice;\n\npublic class ServicePlanTest_A6 implements JavaExecutor {\n    private ActivityRuntimeContext context;\n\n    public void initialize(ActivityRuntimeContext context) throws MdwJavaException {\n        this.context = context;\n    }\n\n    public Object execute(Map<String,Object> variables) throws JavaExecutionException  {\n        \n        Map<String,Object> bindings = new HashMap<>();\n        bindings.put(\"greeting\", \"hello\");\n        bindings.put(\"requestMapper\", \"com.centurylink.mdw.tests.microservice/UserRequestMapper.groovy\");\n        bindings.put(\"intVar\", 123);\n        \n        Microservice microservice = new Microservice(\n                context,\n                \"admin/createUser\",\n                context.getProps().get(\"mdw.services.url\") + \"/services/Users\",\n                \"POST\",\n                \"com.centurylink.mdw.microservice/${StandardInvoke}.proc\",\n                true,\n                1,\n                true,\n                \"\",\n                bindings\n        );\n\n        List<Microservice> microservices = new ArrayList<>();\n        microservices.add(microservice);\n        ServicePlan servicePlan = new ServicePlan(microservices);\n        variables.put(\"servicePlan\", servicePlan);\n                \n        return null;\n    }\n}\n"
    Output Documents: '["servicePlan"]'
    display: x=145,y=277,w=106,h=68
  links:
  - id: L5
    attributes:
      display: type=Elbow,x=372,y=319,xs=255&490,ys=319&319
    event: FINISH
    to: S2
textNotes:
- id: N3
  attributes:
    display: x=232,y=45,w=149,h=22
  text: Just tests the DSL
variables:
  language:
    type: java.lang.String
  request:
    type: com.centurylink.mdw.model.Jsonable
  servicePlan:
    type: org.yaml.snakeyaml.Yaml
  testCase:
    type: java.lang.String
